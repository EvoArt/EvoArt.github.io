<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
    <link rel="stylesheet" href="/css/franklin.css">
<link rel="stylesheet" href="/css/tufte.css">
<link rel="stylesheet" href="/css/latex.css">
<link rel="stylesheet" href="/css/adjust.css"> <!-- sheet to overwrite some clashing styles -->
<link rel="icon" href="/assets/favicon.png">

     <title>demo 2 1</title>  
</head>

<body>
<div id="layout">
  <div id="menu">
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="/menu1/">Ecological detective</a></li>
      <li><a href="/menu2/">My models</a></li>
      <li><a href="/menu3/">BDA Demos</a></li>
      <li><a href="/menu4/">Social Evo</a></li>
    </ul>
  </div>
  <div id="main">

 
   <link rel="stylesheet" href="/css/weave.css"> 
   <script type="text/x-mathjax-config"> 
     MathJax.Hub.Config({ 
       tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}, 
       TeX: { equationNumbers: { autoNumber: "AMS" } } 
     }); 
   </script> 
   <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> 
  


<!-- Content appended here -->
<div class="franklin-content">

  <div class ="container">
    <div class = "row">
      <div class = "col-md-12 twelve columns">
        <div class="title">
          <h1 class="title">Bayesian data analysis demo 2.1</h1>
          <h5>Aki Vehtari, Markus Paasiniemi, Arthur Newbury</h5>
          
        </div>

        <h2>Probability of a girl birth given placenta previa &#40;BDA3 p. 37&#41;.</h2>
<p>437 girls and 543 boys have been observed. Calculate and plot the posterior distribution of the proportion of girls <span class="math">$\theta$</span>, using uniform prior on <span class="math">$\theta$</span>.</p>
<p>CairoMakie.jl is used for plotting to install new packages, type e.g. &#93; add CairoMakie</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>CairoMakie</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Distributions</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>DataFrames</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Colors</span><span class='hljl-t'>
</span><span class='hljl-nf'>set_theme!</span><span class='hljl-p'>(</span><span class='hljl-nf'>theme_minimal</span><span class='hljl-p'>(),</span><span class='hljl-n'>Axis</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>leftspinevisible</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'>
</span><span class='hljl-n'>yticklabelsvisible</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>,),)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: theme_minimal not defined
</pre>


<p>Posterior is Beta&#40;438,544&#41;</p>


<pre class='hljl'>
<span class='hljl-cs'># evenly spaced values can be produced by the syntax start:step:stop</span><span class='hljl-t'>
</span><span class='hljl-n'>df1</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>DataFrame</span><span class='hljl-p'>(</span><span class='hljl-t'> </span><span class='hljl-n'>θ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.375</span><span class='hljl-oB'>:</span><span class='hljl-nfB'>0.001</span><span class='hljl-oB'>:</span><span class='hljl-nfB'>0.525</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>α</span><span class='hljl-p'>,</span><span class='hljl-n'>β</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>438</span><span class='hljl-p'>,</span><span class='hljl-ni'>544</span><span class='hljl-t'>
</span><span class='hljl-n'>posterior</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Beta</span><span class='hljl-p'>(</span><span class='hljl-n'>α</span><span class='hljl-p'>,</span><span class='hljl-n'>β</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'># the pdf function &#39;knows&#39; when it is supplied a Beta distribution</span><span class='hljl-t'>
</span><span class='hljl-n'>df1</span><span class='hljl-oB'>.</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-n'>pdf</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>posterior</span><span class='hljl-p'>,</span><span class='hljl-n'>df1</span><span class='hljl-oB'>.</span><span class='hljl-n'>θ</span><span class='hljl-p'>);</span>
</pre>



<p>compute also 95&#37; central interval</p>


<pre class='hljl'>
<span class='hljl-cs'># LinRange creates evenly spaced values from 2.5% quantile</span><span class='hljl-t'>
</span><span class='hljl-cs'># to 97.5% quantile (i.e., 95% central interval)</span><span class='hljl-t'>
</span><span class='hljl-cs'># &#39;...&#39; tells Julia to unpack the output from the quantile function </span><span class='hljl-t'>
</span><span class='hljl-cs'># compute the posterior density</span><span class='hljl-t'>
</span><span class='hljl-n'>df2</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-nf'>DataFrame</span><span class='hljl-p'>(</span><span class='hljl-n'>θ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>LinRange</span><span class='hljl-p'>(</span><span class='hljl-nf'>quantile</span><span class='hljl-p'>(</span><span class='hljl-n'>posterior</span><span class='hljl-p'>,[</span><span class='hljl-nfB'>0.025</span><span class='hljl-p'>,</span><span class='hljl-nfB'>0.975</span><span class='hljl-p'>])</span><span class='hljl-oB'>...</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>100</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-n'>df2</span><span class='hljl-oB'>.</span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-n'>pdf</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>posterior</span><span class='hljl-p'>,</span><span class='hljl-n'>df2</span><span class='hljl-oB'>.</span><span class='hljl-n'>θ</span><span class='hljl-p'>);</span>
</pre>



<p>Plot posterior &#40;Beta&#40;438,544&#41;&#41; and 48.8&#37; line for population average</p>


<pre class='hljl'>
<span class='hljl-n'>fig</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ax</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>post</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>lines</span><span class='hljl-p'>(</span><span class='hljl-n'>df1</span><span class='hljl-oB'>.</span><span class='hljl-n'>θ</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>df1</span><span class='hljl-oB'>.</span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:black</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linewidth</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>4</span><span class='hljl-p'>,</span><span class='hljl-t'>
</span><span class='hljl-n'>axis</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-n'>title</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;Posterior distribution given uniform prior&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'>
</span><span class='hljl-n'>titlesize</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-ni'>24</span><span class='hljl-p'>,</span><span class='hljl-n'>backgroundcolor</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:transparent</span><span class='hljl-p'>,),</span><span class='hljl-t'>
</span><span class='hljl-n'>figure</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-n'>backgroundcolor</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:transparent</span><span class='hljl-p'>,))</span><span class='hljl-t'>
</span><span class='hljl-cs'># Add a layer of colorized 95% posterior interval</span><span class='hljl-t'>
</span><span class='hljl-n'>i95</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>band!</span><span class='hljl-p'>(</span><span class='hljl-n'>df2</span><span class='hljl-oB'>.</span><span class='hljl-n'>θ</span><span class='hljl-p'>,</span><span class='hljl-nf'>fill</span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-nf'>length</span><span class='hljl-p'>(</span><span class='hljl-n'>df2</span><span class='hljl-oB'>.</span><span class='hljl-n'>p</span><span class='hljl-p'>)),</span><span class='hljl-t'> </span><span class='hljl-n'>df2</span><span class='hljl-oB'>.</span><span class='hljl-n'>p</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-sc'>:blue</span><span class='hljl-p'>,</span><span class='hljl-nfB'>0.2</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-cs'># Add the proportion of girl babies in general population</span><span class='hljl-t'>
</span><span class='hljl-n'>pop</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>vlines!</span><span class='hljl-p'>(</span><span class='hljl-n'>ax</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nfB'>0.488</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>color</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:black</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>linestyle</span><span class='hljl-oB'>=:</span><span class='hljl-n'>dash</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-cs'># Decorate the plot a little</span><span class='hljl-t'>
</span><span class='hljl-nf'>Legend</span><span class='hljl-p'>(</span><span class='hljl-n'>fig</span><span class='hljl-p'>[</span><span class='hljl-ni'>2</span><span class='hljl-p'>,</span><span class='hljl-ni'>1</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-n'>post</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>i95</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pop</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-s'>&quot;Poseterior density = Beta(</span><span class='hljl-si'>$</span><span class='hljl-p'>(</span><span class='hljl-n'>α</span><span class='hljl-p'>)</span><span class='hljl-s'>,</span><span class='hljl-si'>$</span><span class='hljl-p'>(</span><span class='hljl-n'>β</span><span class='hljl-p'>)</span><span class='hljl-s'>)&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> 
</span><span class='hljl-s'>&quot;95% posterior interval&quot;</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-s'>&quot;population average&quot;</span><span class='hljl-p'>],</span><span class='hljl-t'>
</span><span class='hljl-n'>orientation</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-sc'>:horizontal</span><span class='hljl-p'>,</span><span class='hljl-n'>tellwidth</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>false</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>tellheight</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-kc'>true</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>fig</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: lines not defined
</pre>



        <HR/>
        <div class="footer">
          <p>
            Published from <a href="demo21.jmd">demo21.jmd</a>
            using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.12 on 2023-11-13.
          </p>
        </div>
      </div>
    </div>
  </div>

<div class="page-foot">
  <div class="copyright">
    &copy; Arthur Newbury. Last modified: November 13, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->
        </div> <!-- end of id=main -->
    </div> <!-- end of id=layout -->
    
    
  </body>
</html>
